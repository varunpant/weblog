<!doctype html><html lang=en><head><title>Ternary search tree :: Varun Pant — WebLog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="In computer science, a ternary search tree is a type of prefix tree where nodes are arranged as a binary search tree. Like other prefix trees, a ternary search tree can be used as an associative map structure with the ability for incremental string search. However, ternary search trees are more space efficient compared to standard prefix trees, at the cost of speed. Common applications for ternary search trees include spell-checking and auto-completion."><meta name=keywords content="Cloud,maps,GIS,Google Cloud,Google Maps,Openlayer,Javascript,go,Hadoop,BigData,Spark"><meta name=robots content="noodp"><link rel=canonical href=https://varunpant.com/posts/ternary-search-tree/><link type=application/opensearchdescription+xml rel=search title="Varun Pant" href=//www.varunpant.com/opensearch.axd><link rel=me type=text/html href="//plus.google.com/108455320594011020517?rel=me"><link rel=me type=text/html href=//varunpant.com/feed><link rel=me type=text/html href=//twitter.com/varunpant><link rel=me type=text/html href=//www.facebook.com/varun.pant><meta name=msvalidate.01 content="B96ED99B0213B547253C91D27272A5E4"><meta name=google-site-verification content="yu9tlev9-FkUUc0UkPrKP-8ren886--1FcSINU0TJDY"><meta http-equiv=x-xrds-location content="//www.myopenid.com/xrds?username=varunpant.myopenid.com"><meta name=syndication content="//feeds.feedburner.com/varun.pant"><link rel=stylesheet href=https://varunpant.com/assets/style.css><link rel=stylesheet href=https://varunpant.com/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://varunpant.com/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://varunpant.com/img/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:title content="Ternary search tree"><meta name=twitter:description content="In computer science, a ternary search tree is a type of prefix tree where nodes are arranged as a binary search tree. Like other prefix trees, a ternary search tree can be used as an associative map structure with the ability for incremental string search. However, ternary search trees are more space efficient compared to standard prefix trees, at the cost of speed. Common applications for ternary search trees include spell-checking and auto-completion."><meta property="og:title" content="Ternary search tree"><meta property="og:description" content="In computer science, a ternary search tree is a type of prefix tree where nodes are arranged as a binary search tree. Like other prefix trees, a ternary search tree can be used as an associative map structure with the ability for incremental string search. However, ternary search trees are more space efficient compared to standard prefix trees, at the cost of speed. Common applications for ternary search trees include spell-checking and auto-completion."><meta property="og:type" content="article"><meta property="og:url" content="https://varunpant.com/posts/ternary-search-tree/"><meta property="article:published_time" content="2014-01-26T00:00:00+00:00"><meta property="article:modified_time" content="2014-01-26T00:00:00+00:00"><meta property="og:site_name" content="Varun Pant"><section><div id=ta class=advert><script type=text/javascript>google_ad_client="ca-pub-1110730152886910";google_ad_slot="7384719372";google_ad_width=468;google_ad_height=60;</script><script type=text/javascript src=//pagead2.googlesyndication.com/pagead/show_ads.js></script></div></section></head><body><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>Varun Pant</span>
<span class=logo__cursor></span></a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/archives>Archives</a></li><li><a href=/feed.xml>Feed</a></li><li><a href=/showcase>Showcase</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/archives>Archives</a></li><li><a href=/feed.xml>Feed</a></li><li><a href=/showcase>Showcase</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h2 class=post-title><a href=https://varunpant.com/posts/ternary-search-tree/>Ternary search tree</a></h2><div class=post-meta><span class=post-date>2014-01-26</span>
<span class=post-author>— Varun Pant</span>
<span class=post-read-time>— 4 min read</span></div><span class=post-tags>#<a href=https://varunpant.com/tags/.net/>.net</a>&nbsp;
#<a href=https://varunpant.com/tags/datastructure/>datastructure</a>&nbsp;</span><div class=post-content><p>In <a href=http://en.wikipedia.org/wiki/Computer_science>computer science</a>, a <strong>ternary search tree</strong> is a type of <a href=http://en.wikipedia.org/wiki/Trie>prefix tree</a> where nodes are arranged as a <a href=http://en.wikipedia.org/wiki/Binary_search_tree>binary search tree</a>. Like other prefix trees, a ternary search tree can be used as an <a href=http://en.wikipedia.org/wiki/Associative_map>associative map</a> structure with the ability for incremental <a href=http://en.wikipedia.org/wiki/String_search>string search</a>. However, ternary search trees are more space efficient compared to standard prefix trees, at the cost of speed. Common applications for ternary search trees include <a href=http://en.wikipedia.org/wiki/Spell-check>spell-checking</a> and <a href=http://en.wikipedia.org/wiki/Auto-completion>auto-completion</a>.</p><p>As with other trie data structures, each node in a ternary search tree represents a prefix of the stored strings. All strings in the middle subtree of a node start with that prefix.</p><p>In this blog post I present a c# version of Ternary Search Tree.</p><h3 id=the-interface>The interface</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#66d9ef>interface</span> ITernaryTree&lt;T&gt;
   {
       <span style=color:#66d9ef>void</span> Add(<span style=color:#66d9ef>string</span> key, T <span style=color:#66d9ef>value</span>);
       <span style=color:#66d9ef>bool</span> Contains(<span style=color:#66d9ef>string</span> key);
       System.Collections.Generic.IEnumerable&lt;<span style=color:#66d9ef>string</span>&gt; Keys { <span style=color:#66d9ef>get</span>; }
       <span style=color:#66d9ef>int</span> Length { <span style=color:#66d9ef>get</span>; }
       System.Collections.Generic.IEnumerable&lt;T&gt; NearSearch(<span style=color:#66d9ef>string</span> query, <span style=color:#66d9ef>int</span> distance);
       System.Collections.Generic.IEnumerable&lt;<span style=color:#66d9ef>string</span>&gt; PrefixMatch(<span style=color:#66d9ef>string</span> prefix);
       System.Collections.Generic.IEnumerable&lt;T&gt; Search(<span style=color:#66d9ef>string</span> prefix);
       T <span style=color:#66d9ef>this</span>[<span style=color:#66d9ef>string</span> key] { <span style=color:#66d9ef>get</span>; }
       System.Collections.Generic.IEnumerable&lt;<span style=color:#66d9ef>string</span>&gt; WildcardMatch(<span style=color:#66d9ef>string</span> pat);
   }
</code></pre></div><p>The interface above defines the API for the data structure. Lets take a deeper look.</p><p>void Add(string key, T value) Add a key value pair in the tree. bool Contains(string key) Check whether a key is in tree. IEnumerable Keys Return all keys in the tree. int Length Returns the length of the tree. IEnumerable NearSearch(string query, int distance) Returns all values for keys in the dictionary that are within a given Hamming distance of a query. IEnumerable PrefixMatch(string prefix) Returns all keys starting with a given prefix. IEnumerable Search(string prefix) Searches all values of keys starting with given prefix. T this[string key] Gets the node value with the specified key IEnumerable WildcardMatch(string pat) Returns all keys matching given wilcard pattern.</p><h3 id=the-trie-node>The Trie Node</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Node</span>
       {
           <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>           <span style=color:#75715e>/// character
</span><span style=color:#75715e></span>           <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>           <span style=color:#66d9ef>internal</span> <span style=color:#66d9ef>char</span> c;

           <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>           <span style=color:#75715e>/// The left, middle, and right subtries.
</span><span style=color:#75715e></span>           <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>           <span style=color:#66d9ef>internal</span> Node left, mid, right;

           <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>           <span style=color:#75715e>/// The value associated .
</span><span style=color:#75715e></span>           <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>           <span style=color:#66d9ef>internal</span> T <span style=color:#66d9ef>value</span>;
       }
</code></pre></div><p>The Class is mostly self explanatory, but the key points to note is that it contains three internal node(sub-tries) unlike a traditional trie node.</p><p>Adding node in the data structure</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>      <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// Adds the specified key.
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;key&#34;&gt;The key.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;value&#34;&gt;The value.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Add(<span style=color:#66d9ef>string</span> key, T <span style=color:#66d9ef>value</span>)
       {
           <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>string</span>.IsNullOrEmpty(key)) { <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> InvalidOperationException(<span style=color:#e6db74>&#34;Keys cannot be null or empty.&#34;</span>); }
           <span style=color:#66d9ef>if</span> (!Contains(key)) N++;
           root = Add(root, key, <span style=color:#66d9ef>value</span>, <span style=color:#ae81ff>0</span>);
       }

       <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// Adds the specified node in the tree.
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;node&#34;&gt;The Node.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;key&#34;&gt;The key.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;value&#34;&gt;The val.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;charIndex&#34;&gt;The d.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;returns&gt;&lt;/returns&gt;
</span><span style=color:#75715e></span>       Node Add(Node node, <span style=color:#66d9ef>string</span> key, T <span style=color:#66d9ef>value</span>, <span style=color:#66d9ef>int</span> charIndex)
       {
           <span style=color:#66d9ef>char</span> charAtIndex = key[charIndex];
           <span style=color:#66d9ef>if</span> (node == <span style=color:#66d9ef>null</span>) { node = <span style=color:#66d9ef>new</span> Node(); node.c = charAtIndex; }
           <span style=color:#66d9ef>if</span> (charAtIndex &lt; node.c) node.left = Add(node.left, key, <span style=color:#66d9ef>value</span>, charIndex);
           <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (charAtIndex &gt; node.c) node.right = Add(node.right, key, <span style=color:#66d9ef>value</span>, charIndex);
           <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (charIndex &lt; key.Length - <span style=color:#ae81ff>1</span>)
               node.mid = Add(node.mid, key, <span style=color:#66d9ef>value</span>, charIndex + <span style=color:#ae81ff>1</span>);
           <span style=color:#66d9ef>else</span> node.<span style=color:#66d9ef>value</span> = <span style=color:#66d9ef>value</span>;
           <span style=color:#66d9ef>return</span> node;
       }
</code></pre></div><h3 id=get>Get</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>       <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// Gets the specified x.
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;node&#34;&gt;The x.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;key&#34;&gt;The key.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;charIndex&#34;&gt;The d.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;returns&gt;&lt;/returns&gt;
</span><span style=color:#75715e></span>       Node Get(Node node, <span style=color:#66d9ef>string</span> key, <span style=color:#66d9ef>int</span> charIndex)
       {
           <span style=color:#66d9ef>if</span> (node == <span style=color:#66d9ef>null</span>) <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
           <span style=color:#66d9ef>char</span> c = key[charIndex];
           <span style=color:#66d9ef>if</span> (c &lt; node.c) <span style=color:#66d9ef>return</span> Get(node.left, key, charIndex);
           <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (c &gt; node.c) <span style=color:#66d9ef>return</span> Get(node.right, key, charIndex);
           <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (charIndex &lt; key.Length - <span style=color:#ae81ff>1</span>)
               <span style=color:#66d9ef>return</span> Get(node.mid, key, charIndex + <span style=color:#ae81ff>1</span>);
           <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>return</span> node;
       }
</code></pre></div><p>and finally</p><h3 id=prefixmatch>PrefixMatch</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>       <span style=color:#75715e>/// &lt;summary&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// Returns all keys starting with a given prefix.
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;/summary&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;param name=&#34;prefix&#34;&gt;The prefix.&lt;/param&gt;
</span><span style=color:#75715e></span>       <span style=color:#75715e>/// &lt;returns&gt;&lt;/returns&gt;
</span><span style=color:#75715e></span>       <span style=color:#66d9ef>public</span> IEnumerable&lt;<span style=color:#66d9ef>string</span>&gt; PrefixMatch(<span style=color:#66d9ef>string</span> prefix)
       {
           Queue&lt;<span style=color:#66d9ef>string</span>&gt; queue = <span style=color:#66d9ef>new</span> Queue&lt;<span style=color:#66d9ef>string</span>&gt;();
           Node node = Get(root, prefix, <span style=color:#ae81ff>0</span>);
           <span style=color:#66d9ef>if</span> (node == <span style=color:#66d9ef>null</span>) <span style=color:#66d9ef>return</span> queue;
           <span style=color:#66d9ef>if</span> (node.<span style=color:#66d9ef>value</span> != <span style=color:#66d9ef>null</span>) queue.Enqueue(prefix);
           Collect(node.mid, prefix, queue);
           <span style=color:#66d9ef>return</span> queue;
       }
</code></pre></div><p>To see a complete working example check out the Github page <a href=https://github.com/varunpant/TernaryTree/blob/master/TernaryTree/TernarySearchTree/TernaryTree.cs>here</a>.</p><p>Full repo can be found <a href=https://github.com/varunpant/TernaryTree>here</a>. There is a test web application demonstrating auto suggest included in the project, I will write more about it in a later post.</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://varunpant.com/posts/how-to-make-a-web-crawler-in-python/><span class=button__icon>←</span>
<span class=button__text>how to make a web crawler in python</span></a></span>
<span class="button next"><a href=https://varunpant.com/posts/gheat-java-heat-maps/><span class=button__text>Gheat Java – Heat maps</span>
<span class=button__icon>→</span></a></span></div></div><div id=blog-comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"varunpant"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><footer class=footer><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>Varun Pant</span>
<span class=logo__cursor></span></a><div class=copyright><span>© 2019 Powered by <a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by <a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span></div></div></footer><script src=https://varunpant.com/assets/main.js></script><script src=https://varunpant.com/assets/prism.js></script><section><div class=advert id=ta2><script type=text/javascript>google_ad_client="ca-pub-1110730152886910";google_ad_slot="1639236970";google_ad_width=728;google_ad_height=90;</script><script type=text/javascript src=//pagead2.googlesyndication.com/pagead/show_ads.js></script></div></section><script id=dsq-count-scr src=//varunpant.disqus.com/count.js async></script></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-16978408-1','auto');ga('send','pageview');}</script></body></html>